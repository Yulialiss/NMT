{% extends "profile_app/base.html" %}

{% block content %}
<html>
<head>
    <title>–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ç–µ—Å—Ç—É</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/style_result.css' %}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
</head>
<body>
    <h2 class="test-result-title">–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∑ —Ç–µ–º–∏ {{ result.test.title }}</h2>
    <div class="answer-grid">
        {% for question in questions %}
            {% if question.id in user_answers %}
                <div class="answer-box incorrect">{{ forloop.counter }}</div>
            {% else %}
                <div class="answer-box correct">{{ forloop.counter }}</div>
            {% endif %}
        {% endfor %}
    </div>
    <p class="result-info">–í–∞—à–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π {{ result.score }} –∑ {{ result.max_score }}</p>

    <p class="time-spent">{{ formatted_time_spent }}</p>

    {% if time_up %}
        <div class="alert alert-warning">
            –ß–∞—Å –¥–ª—è –ø—Ä–æ—Ö–æ–¥–∂–µ–Ω–Ω—è —Ç–µ—Å—Ç—É –≤–∏–π—à–æ–≤!
        </div>
    {% endif %}

<h2 class="question-details-title">–î–µ—Ç–∞–ª—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π:</h2>
<ul class="question-list">
    {% for question in questions %}
        <li class="question-item">
            <strong class="question-text">{{ forloop.counter }}. {{ question.text }}</strong>
            <ul class="answer-list">
                {% for answer in question.answers.all %}
                    <li class="answer-item">
                        {% if answer.is_correct %}
                            <strong class="correct-answer">‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞: {{ answer.text }}</strong>
                        {% else %}
                            <span class="incorrect-answer">‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞: {{ answer.text }}</span>
                        {% endif %}
                    </li>
                {% endfor %}
            </ul>
            {% if question.id in user_answers %}
                <p class="user-answer">
                    –í–∞—à–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å:
                    {% for user_answer in user_answers %}
                        {% if user_answer.question.id == question.id %}
                            <strong class="user-answer-text">{{ user_answer.answer.text }}</strong>
                        {% endif %}
                    {% endfor %}
                </p>
            {% else %}
                <p class="no-answer">–í–∞—à–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å: –ù–µ–º–∞—î</p>
            {% endif %}
        </li>
    {% endfor %}
</ul>

    <form action="{% url 'download_test_result' result.id %}" method="get" class="custom-form">
                    <button type="submit" class="download-btn">üì•</button>
                </form>
    <a href="{% url 'subject_list' %}" class="circle-icon">
        <i class="bi bi-reply"></i>
    </a>
        <a href="{% url 'test_detail' test_id=result.test.id %}" class="resultrevansh"><i class="bi bi-arrow-clockwise"></i></a>


</body>
</html>
{% endblock %}
